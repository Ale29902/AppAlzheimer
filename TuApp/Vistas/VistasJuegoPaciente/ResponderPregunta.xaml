<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:TuApp.VistasModelo"
             x:Class="TuApp.ResponderPregunta"
             NavigationPage.HasBackButton="False"
             BackgroundColor="{DynamicResource BasePageColor}">

    <ContentPage.BindingContext>
        <vm:PreguntaViewModel />
    </ContentPage.BindingContext>

    <Grid RowDefinitions="*,Auto"
          Padding="20"
          BackgroundColor="{DynamicResource BasePageColor}">

        <!-- Contenido desplazable -->
        <ScrollView Grid.Row="0">
            <VerticalStackLayout x:Name="mainLayout"
                                 Padding="0"
                                 Spacing="25"
                                 VerticalOptions="Start"
                                 HorizontalOptions="FillAndExpand">

                <!-- Botón de regreso arriba -->
                <HorizontalStackLayout HorizontalOptions="End"
                                       x:Name="layoutBotonVolver">
                    <Button x:Name="btnFlechaVolver"
                            Text="←"
                            FontSize="36"
                            FontAttributes="Bold"
                            BackgroundColor="Transparent"
                            TextColor="{DynamicResource PrimaryColor}"
                            Clicked="BtnFlechaVolver_Clicked" />
                </HorizontalStackLayout>

                <!-- Pregunta -->
                <Label x:Name="lblPregunta"
                       FontSize="22"
                       FontAttributes="Bold"
                       TextColor="{DynamicResource BaseTextColor}"
                       HorizontalTextAlignment="Center"
                       HorizontalOptions="Center" />

                <!-- Imagen -->
                <Image x:Name="imgPregunta"
                       HeightRequest="160"
                       Aspect="AspectFit"
                       VerticalOptions="Center"
                       Margin="0,10,0,10" />

                <!-- Opciones -->
                <CollectionView x:Name="OpcionesCollection"
                                SelectionMode="None"
                                BackgroundColor="Transparent">
                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Style="{StaticResource TileButtonStyle}"
                                   Padding="10"
                                   Margin="0,5"
                                   BorderColor="{DynamicResource Gray300}">
                                <Frame.GestureRecognizers>
                                    <TapGestureRecognizer Tapped="Opcion_Tapped"
                                                          CommandParameter="{Binding .}" />
                                </Frame.GestureRecognizers>
                                <Label Text="{Binding Descripcion}"
                                       FontSize="16"
                                       TextColor="{DynamicResource BaseTextColor}" />
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <!-- Resultado -->
                <Label x:Name="lblResultadoFinal"
                       FontSize="18"
                       TextColor="{DynamicResource OkColor}"
                       HorizontalTextAlignment="Center"
                       HorizontalOptions="Center"
                       IsVisible="False"
                       Margin="0,20,0,0" />
            </VerticalStackLayout>
        </ScrollView>

        <!-- Botón fijo abajo -->
        <Button Grid.Row="1"
                x:Name="btnRegresar"
                Text="Regresar"
                Style="{StaticResource PrimaryButtonStyle}"
                WidthRequest="200"
                HeightRequest="55"
                Clicked="btnRegresar_Clicked"
                IsVisible="False"
                HorizontalOptions="Center"
                Margin="0,10,0,10" />
    </Grid>
</ContentPage>
